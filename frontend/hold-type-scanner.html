<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Hold Type Scanner (alias)</title>
  <style>
    body{font-family:sans-serif;padding:24px;background:#fafafa}
    #counts{display:flex;gap:12px}
    .countBox{padding:8px;border:1px solid #ddd;border-radius:6px}
    #winnerBanner{margin-top:12px;padding:10px;background:#e6ffe6;display:none}
  </style>
</head>
<body>
  <h1>Hold Type Scanner</h1>
  <div id="counts">
    <div class="countBox">G: <span id="gcount" data-test-id="gcount">0</span></div>
    <div class="countBox">W: <span id="wcount" data-test-id="wcount">0</span></div>
    <div class="countBox">F: <span id="fcount" data-test-id="fcount">0</span></div>
  </div>
  <div id="winnerBanner" data-test-id="hold-winner">WINNER: <span id="winnerText"></span></div>

  <script>
    async function fetchHoldState() {
      try {
        const r = await fetch('/api/hold/state');
        if (!r.ok) return null;
        return await r.json();
      } catch (e) { return null; }
    }

    async function updateCounts() {
      const s = await fetchHoldState();
      if (s && s.counts) {
        document.getElementById('gcount').textContent = s.counts.g || 0;
        document.getElementById('wcount').textContent = s.counts.w || 0;
        document.getElementById('fcount').textContent = s.counts.f || 0;
        if (s.winner) {
          document.getElementById('winnerText').textContent = s.winner;
          document.getElementById('winnerBanner').style.display = 'block';
        }
        return;
      }
      try {
        const r2 = await fetch('/api/hold/status');
        if (!r2.ok) return;
        const j = await r2.json();
        if (j && j.counts) {
          document.getElementById('gcount').textContent = j.counts.g || 0;
          document.getElementById('wcount').textContent = j.counts.w || 0;
          document.getElementById('fcount').textContent = j.counts.f || 0;
        }
      } catch(e){}
    }

    (async () => {
      await updateCounts();
      setInterval(updateCounts, 700);
    })();
  </script>
</body>
</html>